----------------------------------------------------------
　SceneSplitter.jsx
　version 1.2(2011.08.02)
----------------------------------------------------------

■概要
オーディオレイヤーにつけられたマーカーを「シーンの区切り」と見なし、
シーン単位のコンポジションを自動生成するスクリプトです。
音楽に映像をつけるときとかに便利だと思います。

ちなみにマーカーは、プレビュー中にテンキーの[*]を押すことで、選択中のレイヤーにつけられます。

■インストール方法
AEのフォルダ内部、Support Files\Scriptsにコピーしてください。
あるいは、Support Files\Scripts\ScriptUI Panelsに入れれば、ScriptUI Panelとして利用できます。（こちらおすすめ）


■仕様
生成されるコンポジションは次のような仕様です。

・スクリプトを実行したコンポジションの、縦横サイズ・アスペクト比・フレームレートが反映されます。
・コンポジション名には、マーカーに従って連番が振られます。何番目のシーンか一目瞭然。
・オーディオレイヤーにつけられたマーカーにコメントがついていた場合、それをコンポジション名として付加。
　「Aメロ」とか「サビ」とか予めマーカーコメントを書いておくと作業がわかりやすくなると思います。
・コンポ内にもオーディオレイヤーが複製されているので、すぐに音源にあわせて編集作業に入れます。
・生成されたコンポはプロジェクトパネルではフォルダに纏まっています。削除したいときにはフォルダごとばっさりどうぞ。
・コンポジションの開始タイムコードは、0秒始まりにするか、親のタイムコードに合わせるかを選ぶことができます。


■オプション
・スクリプト実行時に、あらかじめ任意秒数のマージンを前後に指定することができます。
　フェード処理もやりやすい！

・生成されるコンポジションのデュレーション基準として、
　(1)シーン（シーン＋マージンの秒数をデュレーションとして設定）
　(2)オーディオ（生成元となるオーディオレイヤーのデュレーション。inPoint/outPointでシーンを分割）
　(3)親コンポ（アクティブコンポジションのデュレーション。inPoint/outPointでシーンを分割）
　の３種類が選択できます。お好みで使い分けてください。

・「生成するシーンを指定」チェックボックスをオンにすると、生成するシーンを指定することができます。

・前述しましたが、「開始タイムコードを親に合わせる」チェックボックスを使って、
　子コンポの開始タイムコードの扱いを変えることができます。

・詳細設定
　子コンポジション名を指定する書式を編集することができます。詳細な書式仕様はウインドウ内の説明を参照ください。
　また、時間の表記法として「タイムコード」「フレーム数」を選ぶことができます。


■動作環境
CS4(Win)にて動作確認しています。
それ以降のバージョンのAEなら問題なく動くとは思いますが、不具合あったら是非ご報告いただけると嬉しいです。


rlldi
http://twitter.com/rlldi
Email: rlllldi@gmail.com


■更新履歴
20110623 ver1.0
・とりあえず完成
20110624 ver1.1
・コンポのデュレーション基準を3種類から選択可能に
・ScriptUI Panelに対応
20110802 ver1.2
・シーン名の書式を設定可能に (thanks to @athlonz)
・「開始タイムコードを親に合わせる」オプションを新設 (thanks to @athlonz)
・タイムコードを表示するテキストレイヤーを作成するようにした (thanks to @kaeru_boiled)
・生成するシーンを指定できるオプションを新設
・ソースを綺麗にした。コメントたくさん入れたので割と読みやすいと思います。
20111022 ver1.2.1
・ソースをもうちょっと綺麗にしたり、ヘッダを入れたりした。
